<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajer Data Diri</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .profile-pic-preview {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 50%;
            border: 3px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .profile-pic-preview:hover {
            border-color: #6366f1;
        }
        .map-container {
            height: 300px;
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .saved-profile {
            transition: all 0.2s ease;
        }
        .saved-profile:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center text-indigo-700 mb-8">Manajer Data Diri</h1>
        
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">Form Data Diri</h2>
            
            <form id="profileForm" class="space-y-4">
                <div class="flex flex-col items-center mb-4">
                    <input type="file" id="profilePic" accept="image/*" class="hidden">
                    <label for="profilePic">
                        <img id="profilePreview" src="https://placehold.co/150x150" alt="Preview foto profil - silakan upload foto Anda" class="profile-pic-preview">
                    </label>
                    <p class="text-sm text-gray-500 mt-2">Klik untuk upload foto</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="fullName" class="block text-sm font-medium text-gray-700">Nama Lengkap</label>
                        <input type="text" id="fullName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border">
                    </div>
                    
                    <div>
                        <label for="birthDate" class="block text-sm font-medium text-gray-700">Tanggal Lahir</label>
                        <input type="date" id="birthDate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border">
                    </div>
                    
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                        <input type="email" id="email" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border">
                    </div>
                    
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-700">Nomor Telepon</label>
                        <input type="tel" id="phone" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border">
                    </div>
                    
                    <div class="md:col-span-2">
                        <label for="address" class="block text-sm font-medium text-gray-700">Alamat</label>
                        <textarea id="address" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border"></textarea>
                    </div>
                    
                    <div class="md:col-span-2">
                        <label for="mapLink" class="block text-sm font-medium text-gray-700">Link Google Maps</label>
                        <div class="flex space-x-2">
                            <input type="url" id="mapLink" placeholder="https://maps.google.com/..." class="flex-1 mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border">
                            <button type="button" onclick="testMapLink()" class="mt-1 inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                <i class="fas fa-map-marker-alt mr-1"></i> Test
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="map-container hidden bg-gray-200 mt-4" id="mapPreviewContainer">
                    <iframe id="mapPreview" frameborder="0" style="width: 100%; height: 100%;" allowfullscreen></iframe>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="reset" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        <i class="fas fa-redo mr-1"></i> Reset
                    </button>
                    <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        <i class="fas fa-save mr-1"></i> Simpan Data
                    </button>
                </div>
            </form>
        </div>
        
        <div id="savedProfilesContainer" class="space-y-4">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">Data Tersimpan</h2>
            <div id="noProfilesMessage" class="text-center py-8 bg-white rounded-lg shadow">
                <i class="fas fa-user-circle text-4xl text-gray-300 mb-2"></i>
                <p class="text-gray-500">Belum ada data yang tersimpan</p>
            </div>
            <!-- Saved profiles will be inserted here -->
        </div>
    </div>

    <script>
        // DOM Elements
        const profileForm = document.getElementById('profileForm');
        const profilePicInput = document.getElementById('profilePic');
        const profilePreview = document.getElementById('profilePreview');
        const mapLinkInput = document.getElementById('mapLink');
        const mapPreviewContainer = document.getElementById('mapPreviewContainer');
        const mapPreview = document.getElementById('mapPreview');
        const savedProfilesContainer = document.getElementById('savedProfilesContainer');
        const noProfilesMessage = document.getElementById('noProfilesMessage');
        
        // Event Listeners
        profilePicInput.addEventListener('change', handleImageUpload);
        profileForm.addEventListener('submit', handleFormSubmit);
        
        // Load saved profiles on page load
        document.addEventListener('DOMContentLoaded', loadSavedProfiles);
        
        // Functions
        function handleImageUpload(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    profilePreview.src = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        }
        
        function testMapLink() {
            const link = mapLinkInput.value.trim();
            if (link) {
                // Basic validation for Google Maps link
                if (link.includes('google.com/maps') || link.includes('goo.gl/maps')) {
                    mapPreview.src = link.includes('embed') ? link : `https://maps.google.com/maps?q=${encodeURIComponent(link)}&output=embed`;
                    mapPreviewContainer.classList.remove('hidden');
                } else {
                    alert('Masukkan link Google Maps yang valid');
                }
            } else {
                alert('Silakan masukkan link Google Maps terlebih dahulu');
            }
        }
        
        function handleFormSubmit(e) {
            e.preventDefault();
            
            // Get form values
            const profileData = {
                id: Date.now().toString(),
                photo: profilePreview.src,
                fullName: document.getElementById('fullName').value.trim(),
                birthDate: document.getElementById('birthDate').value,
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                address: document.getElementById('address').value.trim(),
                mapLink: mapLinkInput.value.trim(),
                createdAt: new Date().toISOString()
            };
            
            // Basic validation
            if (!profileData.fullName) {
                alert('Nama lengkap harus diisi');
                return;
            }
            
            // Save to localStorage
            saveProfile(profileData);
            
            // Reset form
            profileForm.reset();
            profilePreview.src = 'https://placehold.co/150x150';
            mapPreviewContainer.classList.add('hidden');
            
            // Reload profiles
            loadSavedProfiles();
            
            // Show success message
            showToast('Data berhasil disimpan!', 'success');
        }
        
        function saveProfile(profile) {
            let profiles = JSON.parse(localStorage.getItem('userProfiles')) || [];
            profiles.push(profile);
            localStorage.setItem('userProfiles', JSON.stringify(profiles));
        }
        
        function loadSavedProfiles() {
            const profiles = JSON.parse(localStorage.getItem('userProfiles')) || [];
            
            if (profiles.length === 0) {
                noProfilesMessage.classList.remove('hidden');
                savedProfilesContainer.innerHTML = '<h2 class="text-xl font-semibold mb-4 text-gray-800">Data Tersimpan</h2>';
                savedProfilesContainer.appendChild(noProfilesMessage);
                return;
            }
            
            noProfilesMessage.classList.add('hidden');
            
            let profilesHTML = '';
            profiles.forEach(profile => {
                profilesHTML += `
                    <div class="bg-white rounded-lg shadow-md p-6 saved-profile" data-id="${profile.id}">
                        <div class="flex flex-col md:flex-row md:items-center gap-4">
                            <div class="flex-shrink-0">
                                <img src="${profile.photo}" alt="Foto profil ${profile.fullName}" class="w-20 h-20 rounded-full object-cover border-2 border-gray-200">
                            </div>
                            <div class="flex-grow">
                                <h3 class="text-lg font-semibold text-gray-800">${profile.fullName}</h3>
                                <p class="text-sm text-gray-600">
                                    <i class="fas fa-envelope mr-1"></i> ${profile.email || '-'} | 
                                    <i class="fas fa-phone-alt mr-1 ml-2"></i> ${profile.phone || '-'}
                                </p>
                                <p class="text-sm text-gray-600 mt-1">
                                    <i class="fas fa-birthday-cake mr-1"></i> ${profile.birthDate || '-'} | 
                                    <i class="fas fa-map-marker-alt mr-1 ml-2"></i> ${profile.address || '-'}
                                </p>
                            </div>
                            <div class="flex-shrink-0 flex space-x-2">
                                <button onclick="editProfile('${profile.id}')" class="p-2 text-indigo-600 hover:text-indigo-800">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteProfile('${profile.id}')" class="p-2 text-red-600 hover:text-red-800">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </div>
                        
                        ${profile.mapLink ? `
                        <div class="mt-4">
                            <a href="${profile.mapLink}" target="_blank" class="text-sm text-indigo-600 hover:underline inline-block mb-2">
                                <i class="fas fa-external-link-alt mr-1"></i> Buka Peta
                            </a>
                            <div class="map-container">
                                <iframe src="${profile.mapLink.includes('embed') ? profile.mapLink : `https://maps.google.com/maps?q=${encodeURIComponent(profile.mapLink)}&output=embed`}" frameborder="0" style="width: 100%; height: 100%;" allowfullscreen></iframe>
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
            });
            
            savedProfilesContainer.innerHTML = '<h2 class="text-xl font-semibold mb-4 text-gray-800">Data Tersimpan</h2>' + profilesHTML;
        }
        
        function editProfile(id) {
            const profiles = JSON.parse(localStorage.getItem('userProfiles')) || [];
            const profile = profiles.find(p => p.id === id);
            
            if (profile) {
                // Fill form with profile data
                document.getElementById('fullName').value = profile.fullName;
                document.getElementById('birthDate').value = profile.birthDate;
                document.getElementById('email').value = profile.email || '';
                document.getElementById('phone').value = profile.phone || '';
                document.getElementById('address').value = profile.address || '';
                mapLinkInput.value = profile.mapLink || '';
                
                profilePreview.src = profile.photo;
                
                if (profile.mapLink) {
                    mapPreview.src = profile.mapLink.includes('embed') ? profile.mapLink : `https://maps.google.com/maps?q=${encodeURIComponent(profile.mapLink)}&output=embed`;
                    mapPreviewContainer.classList.remove('hidden');
                }
                
                // Scroll to form
                document.getElementById('profileForm').scrollIntoView({ behavior: 'smooth' });
                
                // Remove the profile (will be re-added when saved)
                deleteProfile(id, false);
            }
        }
        
        function deleteProfile(id, showConfirmation = true) {
            if (showConfirmation && !confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                return;
            }
            
            let profiles = JSON.parse(localStorage.getItem('userProfiles')) || [];
            profiles = profiles.filter(profile => profile.id !== id);
            localStorage.setItem('userProfiles', JSON.stringify(profiles));
            
            loadSavedProfiles();
            showToast('Data berhasil dihapus', 'success');
        }
        
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 px-4 py-2 rounded-md shadow-lg text-white ${
                type === 'success' ? 'bg-green-500' : 'bg-blue-500'
            }`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('opacity-0', 'transition-opacity', 'duration-300');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>

